---
title: 文件自动保存update2-6-1
date: 2020-11-22
tags: 电教平台自动化管理工具集
category: 工具
img: https://s3.ax1x.com/2020/11/22/D3b01J.jpg
cover: true
---
### 简介  
+ 实现Windows下根据时间表自动将指定目录中的文件备份到指定目录
+ 说白了就是根据课程表将课件分类复制到各科目对应的文件夹(需要指定)
+ 可选预先扫描目标文件夹以跳过重复文件
+ 可选保存文件信息以减少扫描时间(就是复制过的课件不再复制)
+ 可选彻底排除重复文件(就是即使有两个没复制过的但仅文件名不同的课件也只会复制其中一个)
+ 性能优化，cpu占用低于1%(环境: Intel core i7-3820@3.6G × 4)
+ 支持排除文件(可以指定不复制的文件,比如桌面上的一堆lnk之类)
+ ......

### v 2.6.1更新内容
+ 修复了Windows7下不能成功读取课程表的问题
+ 修复了科目切换的问题
+ 移除日志中移除空文件夹的输出

### 使用说明
1. 下载后编辑**settings.txt**完成时间配置
2. 在程序所在目录下建立时间表：星期一：**1.txt** 星期二：**2.txt** ……以此类推
3. 完成时间表的配置
4. 运行**start.vbs**
5. 在指定的文件夹中查看文件

### 特别说明
+ 时间表填写可以不按照时间顺序，使用24小时制，一个一行，不能有空行
+ 周天对应的时间表是**0.txt**
+ 时间表填写格式：起始时间 终止时间 文件夹名称
+ 例：7:10 到 8:10 有一节语文课，应写入：
    >7
    >10
    >8
    >10
    >语文
 
+ 目前文件夹快捷选择仅支持**桌面**，如需使用使用，在文件源处填写：**Desktop**
+ 程序文件在：**build-automatic_files_backup-Desktop_Qt_5_14_2_MinGW_32_bit-Release** 中的 **release** 文件夹
+ 请把 **release** 文件夹**完整下载**使用，里面的文件都很重要，否则程序将无法运行
+ **build-automatic_files_backup-Desktop_Qt_5_14_2_MinGW_32_bit-Debug** 文件夹中是调试用的文件
+ **automatic_files_backup** 文件夹中是程序源代码
+ 请不要直接运行 **automatic_files_backup.exe** ，除非你想看见一个大黑框
+ **settings.txt**中排除的文件处请随便填一个，否则不能读取成功

### 填写示例

#### 配置文件：settings.txt
#注释以‘#’开头，一个一行  
#文件源  
J:/Application software/tools/DIY tools/文件自动保存/1.1  
#目标目录  
C:/Users/32154/Desktop/新建文件夹 (2)  
#等待时间，单位为毫秒  
10000  
#文件夹更新检测模式：1按照包含文件哈希值处理(更新及时，占用资源较大) 2按照文件夹修改时间处理(只有文件夹添加或删除文件时才会更新文件，占用资源较少)  
1  
#复制前扫描目标文件夹以保证不复制任何重复文件：1是  2否（占用资源较大，慎选！！！）  
1  
#使用预先保存的哈希文件代替扫描目标文件夹：1是  2否（每次复制或扫描文件都保存其哈希信息替代扫描目标文件夹，若需更新哈希信息，将hash.txt删除即可）  
1  
#排除的文件（夹），一行一个（不可使用通配符）  
xxx.lnk  
yyy.lnk  
数学  
#### 课程表：1.txt
21
10
22
03
语文  
22
03
23
00
数学  
8
59
9
20
英语

### 未来规划更新内容
+ 添加对通配符的支持
+ 双哈希验证